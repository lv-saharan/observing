{
  "version": 3,
  "sources": ["../src/symbols.js", "../src/handler.js", "../src/index.js", "src/index.js"],
  "sourcesContent": ["export const proxySymbol = Symbol(\"observing-proxy\")\r\nexport const setSymbol = Symbol(\"proxy-set\")\r\nexport const delSymbol = Symbol(\"proxy-del\")\r\nexport const wellKnownSymbols = Object.getOwnPropertyNames(Symbol)\r\n    .map(key => Symbol[key])\r\n    .filter(value => typeof value === 'symbol')", "import { proxySymbol, wellKnownSymbols, setSymbol, delSymbol } from \"./symbols\"\r\n\r\nconst proxyMap = new WeakMap()\r\n \r\nexport default class {\r\n    #action = setSymbol\r\n    constructor(...callbacks) {\r\n        this.callbacks = callbacks\r\n    }\r\n    doCallbacks() {\r\n        this.callbacks.forEach(callback => {\r\n            callback()\r\n        })\r\n    }\r\n    // construct(target, args) {\r\n    //     return new target(...args);\r\n    // }\r\n    // defineProperty(target, property, descriptor) {\r\n    //     const result = Reflect.defineProperty(target, property, descriptor)\r\n    //     // this.doCallbacks()\r\n    //     return result\r\n    // }\r\n    deleteProperty(target, property) {\r\n        const result = Reflect.deleteProperty(target, property)\r\n        this.#action = delSymbol\r\n        return result\r\n    }\r\n    get(target, property, receiver) {\r\n        if (property === proxySymbol) {\r\n            return true\r\n        }\r\n        const result = Reflect.get(target, property, receiver)\r\n        if (typeof property === 'symbol' && wellKnownSymbols.includes(key)) {\r\n            return result\r\n        }\r\n\r\n        if (typeof result === \"object\") {\r\n            let proxy = proxyMap.get(result)\r\n            if (proxy === undefined) {\r\n                proxy = new Proxy(result, this)\r\n                proxyMap.set(result, proxy)\r\n            }\r\n            return proxy\r\n        }\r\n        return result;\r\n    }\r\n    has(target, property) {\r\n        return Reflect.has(target, property)\r\n    }\r\n    ownKeys(target) {\r\n        return Reflect.ownKeys(target);\r\n    }\r\n    set(target, property, value, receiver) {\r\n        const result = Reflect.set(target, property, value, receiver)\r\n        if (target instanceof Array && property === \"length\" && this.#action !== delSymbol) {\r\n            return result\r\n        }\r\n        this.doCallbacks()\r\n        this.#action = setSymbol\r\n        return result\r\n    }\r\n}", "import handler from \"./handler\"\r\nimport { proxySymbol } from \"./symbols\"\r\n/**\r\n * observe will create a proxy as observer\r\n * @param {Object} o \r\n * @returns \r\n */\r\nexport function observe(o = {}, ...callbacks) {\r\n    if (o[proxySymbol] === true) {\r\n        return o\r\n    }\r\n    const observer = new Proxy(o, new handler(...callbacks))\r\n    return observer\r\n}\r\n\r\n", "import { observe } from '../../src/index.js'\r\n\r\nlet raw = {\r\n    a: 1,\r\n    b: 2,\r\n    c: 3,\r\n    d: [1, 2, 3]\r\n}\r\n\r\nlet observed = observe(raw, () => {\r\n\r\n    console.log(\"callback1 changed!\", observed)\r\n}, () => {\r\n    console.log(\"callback2 changed!\", observed)\r\n\r\n})\r\n\r\nsetTimeout(() => {\r\n    observed.a++\r\n\r\n}, 2000);\r\n\r\n\r\n\r\nwindow.__o = observed\r\n\r\n\r\n\r\n// let observedArr = observe([1, 3, 4, 6], () => {\r\n\r\n//     console.log(\"callback3 changed!\", observedArr)\r\n// }, () => {\r\n//     console.log(\"callback4 changed!\", observedArr)\r\n\r\n// })\r\n// observedArr.push(7788)\r\n\r\n"],
  "mappings": ";;AAAO,MAAM,cAAc,OAAO,iBAAiB;AAC5C,MAAM,YAAY,OAAO,WAAW;AACpC,MAAM,YAAY,OAAO,WAAW;AACpC,MAAM,mBAAmB,OAAO,oBAAoB,MAAM,EAC5D,IAAI,CAAAA,SAAO,OAAOA,KAAI,EACtB,OAAO,WAAS,OAAO,UAAU,QAAQ;;;ACH9C,MAAM,WAAW,oBAAI,QAAQ;AAE7B,MAAO,kBAAP,MAAqB;AAAA,IACjB,UAAU;AAAA,IACV,eAAe,WAAW;AACtB,WAAK,YAAY;AAAA,IACrB;AAAA,IACA,cAAc;AACV,WAAK,UAAU,QAAQ,cAAY;AAC/B,iBAAS;AAAA,MACb,CAAC;AAAA,IACL;AAAA,IASA,eAAe,QAAQ,UAAU;AAC7B,YAAM,SAAS,QAAQ,eAAe,QAAQ,QAAQ;AACtD,WAAK,UAAU;AACf,aAAO;AAAA,IACX;AAAA,IACA,IAAI,QAAQ,UAAU,UAAU;AAC5B,UAAI,aAAa,aAAa;AAC1B,eAAO;AAAA,MACX;AACA,YAAM,SAAS,QAAQ,IAAI,QAAQ,UAAU,QAAQ;AACrD,UAAI,OAAO,aAAa,YAAY,iBAAiB,SAAS,GAAG,GAAG;AAChE,eAAO;AAAA,MACX;AAEA,UAAI,OAAO,WAAW,UAAU;AAC5B,YAAI,QAAQ,SAAS,IAAI,MAAM;AAC/B,YAAI,UAAU,QAAW;AACrB,kBAAQ,IAAI,MAAM,QAAQ,IAAI;AAC9B,mBAAS,IAAI,QAAQ,KAAK;AAAA,QAC9B;AACA,eAAO;AAAA,MACX;AACA,aAAO;AAAA,IACX;AAAA,IACA,IAAI,QAAQ,UAAU;AAClB,aAAO,QAAQ,IAAI,QAAQ,QAAQ;AAAA,IACvC;AAAA,IACA,QAAQ,QAAQ;AACZ,aAAO,QAAQ,QAAQ,MAAM;AAAA,IACjC;AAAA,IACA,IAAI,QAAQ,UAAU,OAAO,UAAU;AACnC,YAAM,SAAS,QAAQ,IAAI,QAAQ,UAAU,OAAO,QAAQ;AAC5D,UAAI,kBAAkB,SAAS,aAAa,YAAY,KAAK,YAAY,WAAW;AAChF,eAAO;AAAA,MACX;AACA,WAAK,YAAY;AACjB,WAAK,UAAU;AACf,aAAO;AAAA,IACX;AAAA,EACJ;;;ACtDO,WAAS,QAAQ,IAAI,CAAC,MAAM,WAAW;AAC1C,QAAI,EAAE,iBAAiB,MAAM;AACzB,aAAO;AAAA,IACX;AACA,UAAM,WAAW,IAAI,MAAM,GAAG,IAAI,gBAAQ,GAAG,SAAS,CAAC;AACvD,WAAO;AAAA,EACX;;;ACXA,MAAI,MAAM;AAAA,IACN,GAAG;AAAA,IACH,GAAG;AAAA,IACH,GAAG;AAAA,IACH,GAAG,CAAC,GAAG,GAAG,CAAC;AAAA,EACf;AAEA,MAAI,WAAW,QAAQ,KAAK,MAAM;AAE9B,YAAQ,IAAI,sBAAsB,QAAQ;AAAA,EAC9C,GAAG,MAAM;AACL,YAAQ,IAAI,sBAAsB,QAAQ;AAAA,EAE9C,CAAC;AAED,aAAW,MAAM;AACb,aAAS;AAAA,EAEb,GAAG,GAAI;AAIP,SAAO,MAAM;",
  "names": ["key"]
}
